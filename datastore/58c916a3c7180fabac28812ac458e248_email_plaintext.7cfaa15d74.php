<?php

return <<<'VALUE'
"namespace IPS\\Theme;\n\tfunction email_html_core_activity_stream_subscription( $stream, $items, $recipient, $subscription, $viewMore, $email ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $subscription['frequency'] == 'daily' ):\n$return .= <<<CONTENT\n\n\t{$email->language->addToStack( 'email_core_activity_stream_subscription_daily', FALSE, ['sprintf' => $stream->_title])}\n\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t{$email->language->addToStack( 'email_core_activity_stream_subscription_weekly', FALSE, ['sprintf' => $stream->_title])}\n\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n<br \/><br \/>\n<table width='100%' cellpadding='0' cellspacing='0' border='0'>\n\t\nCONTENT;\n\nforeach ( $items as $item ):\n$return .= <<<CONTENT\n\n\t\t\nCONTENT;\n\n$content = $item['object'];\n$return .= <<<CONTENT\n\n\t\t<tr>\n\t\t\t<td>\n\t\t\t\t<table width='100%' cellpadding='0' cellspacing='0' border='0'>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td dir='{dir}' width='40' valign='top' class='hidePhone' style='width: 0; max-height: 0; overflow: hidden; float: left; padding-top: 15px'>\n\t\t\t\t\t\t\t<img src='{$content->author()->get_photo( true, true )}' width='40' height='40' style='border: 1px solid #777777; vertical-align: middle;'>\n\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t<td dir='{dir}' width='30' valign='top' class='hidePhone' style='width: 0; max-height: 0; overflow: hidden; float: left;'>\n\t\t\t\t\t\t\t<span style='display: block; width: 0px; height: 0px; border-width: 15px; border-color: transparent #f9f9f9 transparent transparent; border-style: solid; margin-top: 23px;'><\/span>\n\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t<td dir='{dir}' width='100%' valign='top' style='background: #f9f9f9;'>\n\t\t\t\t\t\t\t<table width='100%' cellpadding='10' cellspacing='0' border='0'>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td width='100%'>\n\t\t\t\t\t\t\t\t\t\t<table width='100%' cellpadding='5' cellspacing='0' border='0'>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td dir='{dir}' width='100%' style=\"font-family: 'Helvetica Neue', helvetica, sans-serif; color: #8d8d8d; font-size: 14px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$itemClass = $item['itemClass'];\n$return .= <<<CONTENT\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h2 style=\"color: #333333; font-weight: bold; line-height: 1.1; font-size: \nCONTENT;\n\nif ( !$item['indexData']['index_title'] ):\n$return .= <<<CONTENT\n16px\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n20px\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n; margin: 0 0 3px 0;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href='{$content->url()}' style='text-decoration: none; color: #333333;'>{$item['itemData'][ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['title'] ]}<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/h2>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( $itemClass::searchResultSummaryLanguage( $item['authorData'], $itemClass::articlesFromIndexData( $itemClass, $item['containerData'] ), $item['indexData'], $item['itemData'], FALSE ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n <a href='{$item['containerUrl']}'>{$item['containerTitle']}<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td dir='{dir}' width='100%' style=\"font-family: 'Helvetica Neue', helvetica, sans-serif; color: #333; font-size: 15px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$emailContent = $email->parseTextForEmail( $content->content(), $email->language, ( \\IPS\\Settings::i()->email_truncate ? 150 : NULL ) );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$emailContent}\nCONTENT;\n\nif ( \\IPS\\Settings::i()->email_truncate AND \\mb_strlen( $content->content() ) > 150 ):\n$return .= <<<CONTENT\n...\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td width='100%'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<table cellpadding='0' cellspacing='0' border='0'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"font-family: 'Helvetica Neue', helvetica, sans-serif; font-size: 14px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href='{$content->url()}'>{$email->language->addToStack('read_more')}<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/email\/spacer.png\" alt='' width=\"20\" height=\"1\" \/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"color: #8d8d8d; font-family: 'Helvetica Neue', helvetica, sans-serif; font-size: 14px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/email\/clock.png\" alt='' width=\"13\" height=\"13\" style=\"vertical-align: middle\" \/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/email\/spacer.png\" alt='' width=\"1\" height=\"1\" \/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href='{$content->url()}' style='color: inherit; text-decoration: none;'>\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\DateTime::ts( $item['indexData']['index_date_created'] )->localeDate( $recipient ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( isset( $itemClass::$databaseColumnMap['num_comments'] ) and isset( $item['itemData'][ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ] ) and $item['itemData'][ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ] > ( $itemClass::$firstCommentRequired ? 1 : 0 ) ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/email\/spacer.png\" alt='' width=\"20\" height=\"1\" \/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"color: #8d8d8d; font-family: 'Helvetica Neue', helvetica, sans-serif; font-size: 14px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/email\/comment_alt.png\" alt='' width=\"13\" height=\"13\" style=\"vertical-align: middle\" \/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"\nCONTENT;\n\n$return .= \\IPS\\Settings::i()->base_url;\n$return .= <<<CONTENT\napplications\/core\/interface\/email\/spacer.png\" alt='' width=\"1\" height=\"1\" \/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a href='{$content->url()}' style='color: inherit; text-decoration: none;'>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nif ( $itemClass::$firstCommentRequired ):\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( $item['itemData'][ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ]-1, ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\n$return .= htmlspecialchars( $item['itemData'][ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['num_comments'] ], ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<\/table>\n\t\t\t\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t\t\t\t\t\t<\/table>\n\t\t\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t\t\t<\/table>\n\t\t\t\t\t\t<\/td>\n\t\t\t\t\t<\/tr>\n\t\t\t\t<\/table>\n\t\t\t<\/td>\n\t\t<\/tr>\n\t\t<tr>\n\t\t\t<td height=\"20\">&nbsp;<\/td>\n\t\t<\/tr>\n\t\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\n    \nCONTENT;\n\nif ( $viewMoreLink ):\n$return .= <<<CONTENT\n\n\n        <tr>\n            <td dir='{dir}' align='center'>\n                <a href='{$stream->url()}' style=\"color: #ffffff; font-family: 'Helvetica Neue', helvetica, sans-serif; text-decoration: none; font-size: 14px; background: \nCONTENT;\n\n$return .= \\IPS\\Settings::i()->email_color;\n$return .= <<<CONTENT\n; line-height: 32px; padding: 0 10px; display: inline-block; border-radius: 3px;\">{$email->language->addToStack('stream_view_more', FALSE)}<\/a>\n            <\/td>\n        <\/tr>\n    \nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n<\/table>\nCONTENT;\n\n\t\treturn $return;\n}\n\tfunction email_plaintext_core_activity_stream_subscription( $stream, $items, $recipient, $subscription, $viewMore, $email ) {\n\t\t$return = '';\n\t\t$return .= <<<CONTENT\n\n\nCONTENT;\n\nif ( $subscription['frequency'] == 'daily' ):\n$return .= <<<CONTENT\n{$email->language->addToStack( 'email_core_activity_stream_subscription_daily', FALSE, ['sprintf' => $stream->_title])}\nCONTENT;\n\nelse:\n$return .= <<<CONTENT\n{$email->language->addToStack( 'email_core_activity_stream_subscription_weekly', FALSE, ['sprintf' => $stream->_title])}\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n\n\nCONTENT;\n\nforeach ( $items as $item ):\n$return .= <<<CONTENT\n\nCONTENT;\n\n$content = $item['object'];\n$return .= <<<CONTENT\n\nCONTENT;\n\n$itemClass = $item['itemClass'];\n$return .= <<<CONTENT\n\n{$item['itemData'][ $itemClass::$databasePrefix . $itemClass::$databaseColumnMap['title'] ]}\n\nCONTENT;\n\n$return .= htmlspecialchars( \\IPS\\DateTime::ts( $item['indexData']['index_date_created'] )->localeDate( $recipient ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n: \nCONTENT;\n\n$return .= htmlspecialchars( $itemClass::searchResultSummaryLanguage( $item['authorData'], $itemClass::articlesFromIndexData( $itemClass, $item['containerData'] ), $item['indexData'], $item['itemData'], FALSE ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n \nCONTENT;\n\n$return .= htmlspecialchars( strip_tags( $item['containerTitle'] ), ENT_QUOTES | ENT_DISALLOWED, 'UTF-8', FALSE );\n$return .= <<<CONTENT\n\n-------\nCONTENT;\n\n$emailContent = $email->parseTextForEmail( $content->content(), $email->language, ( \\IPS\\Settings::i()->email_truncate ? 150 : NULL ) );\n$return .= <<<CONTENT\n\n{$emailContent}\nCONTENT;\n\nif ( \\IPS\\Settings::i()->email_truncate AND \\mb_strlen( $content->content() ) > 150 ):\n$return .= <<<CONTENT\n...\nCONTENT;\n\nendif;\n$return .= <<<CONTENT\n\n-------\nURL: {$content->url()}\n\n\n=========================\n\n\nCONTENT;\n\nendforeach;\n$return .= <<<CONTENT\n\nCONTENT;\n\n\t\treturn $return;\n}"
VALUE;
